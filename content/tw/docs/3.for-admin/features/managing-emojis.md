# 管理自訂表情符號

:::warning

當前，此文件更新中。注意，這裏可能包含過去的資訊。

:::

自定表情符號可由管理員/版主和具有「管理自定義表情符號」權限的使用者管理，方法是從「設置」中訪問「自定表情符號」頁面上的子功能表。
默認情況下，將顯示目前安裝在本地的表情符號清單。
最初，此清單爲空，但您可以通過多種方式添加自定表情符號。

## 從其他實例複製表情符號

您可以輕鬆地從其他實例複製表情符號。

首先，切換到自訂表情符號設定中的「遠端」分頁。您可以透過名稱或主機名來搜尋表情符號。

找到想要的表情符號後，點擊它以開啟選單，即可將該表情符號匯入。

請注意，表情符號可能受到著作權保護，因此在使用前請務必確認相關權利，確保該表情符號可以合法使用。

## 單一表情符號的匯入

如果您有想要設為自訂表情符號的圖片檔案，可以將該圖片匯入為表情符號。

:::danger

若從雲端硬碟匯入表情符號，該檔案仍會保留在雲端硬碟中。
由於 Misskey 不會為此檔案建立副本，若刪除原始檔案，對應的表情符號將無法顯示。

:::

表情符號會被新增至伺服器，之後即可如同一般情況下進行編輯或刪除。

## 一次匯入

表情符號可以以特定格式封裝的 ZIP 檔案進行一次匯入。
此功能可從自訂表情符號選單右上角的選單按鈕中使用。

:::warning

一次匯入可能會覆寫既有的表情符號，或對伺服器造成問題。
請盡可能僅匯入由您自行匯出的表情符號。若需從外部進行一次匯入，請務必確認來源是否可信。

:::

### 封裝表情符號的格式

在最上層目錄中，必須包含一個名為 `meta.json` 的檔案，
此檔案包含有關該封裝表情符號的相關資訊。

此檔案的型別定義如下，其中 `Meta` 代表整個檔案的結構。

```typescript
class Meta {
	metaVersion: number;
	host: string;
	/**
	 * ECMAScript の `Date.prototype.toString` によって返される日時の表現。
	 */
	exportedAt: string;
	emojis: Emoji[];
}

class Emoji {
	downloaded: boolean;
	fileName: string;
	emoji: {
		id: string;
		updatedAt: string;
		name: string;
		host: null;
		category: string;
		originalUrl: string;
		publicUrl: string;
		uri: null;
		type: string;
		aliases: string[];
	};
}
```

目前，匯入表情符號時不會使用或檢查 `Meta` 欄位，但會使用 `emojis` 欄位。

對於每一個 `Emoji`：

- `downloaded`：必須始終設為 true。若此欄位不存在，或其值不是 true，該表情符號將不會被匯入。
- `fileName`：封裝檔案中圖片檔案的檔名。
- `emoji`：與儲存在資料庫中的表情符號相關的資料。目前會使用以下欄位：
  - `name`：使用者輸入的表情符號名稱，例如 `blobfox`（當使用者輸入 `:blobfox:` 時，該表情符號就會顯示）。  
    如果已存在相同名稱的表情符號，**將會被覆寫**
  - `category`：表情符號的分類
  - `aliases`：作為別名新增的字串清單。在管理員 UI 中，這些稱為「標籤」。

## 編輯與刪除表情符號

點擊本地表情符號清單中的自訂表情符號即可編輯其屬性。
點擊自訂表情符號後，會開啟用於編輯其屬性的對話框。
在此對話框中，也可以刪除該表情符號。

:::danger

刪除自訂表情符號後，包含該表情符號的舊貼文中，將只會以文字形式顯示表情符號名稱，該表情符號將無法正確顯示。

:::

請注意，遠端表情符號無法進行編輯或刪除。

每個表情符號可以有一個名稱、類別和多個標籤。
類別用於表情符號選擇器的結構化。
在表情符號選擇器中搜尋時，標籤作為找尋表情符號所使用的別名。

編輯完成後，請點擊對話框右上角的勾號圖示以儲存變更。

### 批次編輯

您可以勾選搜尋欄下方的核取方塊，以對表情符號進行批次編輯。
啟用後，點擊表情符號時將不會開啟編輯對話框，而是會選取該表情符號。

編輯選項會以按鈕的形式顯示在核取方塊下方。
若要恢復為一般操作，請再次取消勾選該核取方塊。
