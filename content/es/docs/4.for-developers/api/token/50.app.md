---
description: Describe cómo obtener un token de acceso antes de la introducción de MiAuth (por debajo de v12.27.0).
---

# Obtención de un token de acceso mediante la creación de una aplicación (antiguo/heredado)

Este documento explica cómo obtener un token de acceso en versiones de Misskey anteriores a la introducción de [MiAuth](./miauth.md) (antes de v12.27.0) y [OAuth](./oauth.md) (antes de v2023.9.0).\
Este método heredado es necesario para las versiones anteriores a la v12.27.0.

## 1. Crear una aplicación

Envía una petición al endpoint [`app/create`](endpoints/app/create.html) para obtener un `appSecret`.

```json
{
    // Nombre de la aplicación
    "name": "test",
    // Descripción de la aplicación
    "description": "mi app de prueba",
    // Permisos de la aplicación
    "permission": ["write:notes"]
}
```

Especificar una `callbackUrl` en el cuerpo de este objeto hará que la solicitud de autorización completada redirija a esa URL, pasando un `token` en la cadena de consulta.

## 2. Autorizando a los clientes

Envía por POST el `appSecret` al endpoint [`auth/session/generate`](endpoints/auth/session/generate).

```json
{
    "appSecret": "fAb12cD34Ef56gH78Ij16kL32Mn64oPf"
}
```

Se devolverá un `token` (para el ejemplo elegiremos `798b9f6e-248d-43a7-a919-fabc664027f1`) y una URL será devuelta. Para autorizar al cliente, navega hasta la URL en un navegador web y permite el acceso.

## 3. Obteniendo un accessToken

Una vez que hayas completado el Paso 2, haz una petición POST de `appSecret` y con el `token` al enpoint [`auth/session/userkey`](endpoints/auth/session/userkey).

```json
{
  "appSecret": "fAb12cD34Ef56gH78Ij16kL32Mn64oPf",
  "token": "798b9f6e-248d-43a7-a919-fabc664027f1"
}
```

Obtendrás una cadena de texto (string) `accessToken`.Sólo se puede obtener un `accessToken` una vez.

## 4. Generar i

Si estás utilizando Node.js, `i` puede generarse utilizando el siguiente código. A diferencia del que se obtiene del Panel de Control, es un número hexadecimal de 64 dígitos.

```javascript
const crypto = require("crypto")
const i = crypto.createHash("sha256")
    .update(accessToken + appSecret, "utf8")
    .digest("hex")
console.log(i)
```

## 5. Probándolo

```javascript
fetch("https://misskey.example/api/notes/create", {
    method: 'POST',
    body: JSON.stringify({
        i: "/* Introduzca i aquí.*/",
        text: "Hello Misskey API World with My Application!"
    }),
    headers: {
        'Content-Type': 'application/json',
    },
	credentials: 'omit',
});
```
