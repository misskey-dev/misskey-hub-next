# 管理自訂表情符號

:::warning

現在、このドキュメントは更新作業中です。過去の情報が含まれていることがありますのでご注意ください。

:::

カスタム絵文字は、管理者・モデレーターと、カスタム絵文字の管理のロールポリシーを持つユーザーが設定からカスタム絵文字ページにあるサブメニューにアクセスして管理できます。
デフォルトでは、現在ローカルにインストールされている絵文字の一覧が表示されます。
最初はこのリストは空ですが、さまざまな方法でカスタム絵文字を追加できます。

## 他のインスタンスから絵文字をコピーする

絵文字は他のインスタンスから簡単にコピーできます。

まず、カスタム絵文字設定の「リモート」タブに切り替えます。絵文字は名前やホストで検索することができます。

欲しい絵文字が見つかったら、それをクリックしてメニューを開き、絵文字をインポートすることができます。

絵文字は著作権保護の対象となる場合がありますので、絵文字が利用できるかどうか、権利面の確認を忘れないようにしましょう。

## 個別の絵文字のインポート

カスタム絵文字にしたい画像ファイルがある場合、その画像を絵文字としてインポートできます。

:::danger

ドライブから絵文字をインポートする場合、ファイルはドライブ内に残ります。
Misskeyはこのファイルのコピーを作成しないため、ファイルを削除すると、絵文字が表示されなくなります。

:::

絵文字がサーバーに追加され、通常通り編集や削除ができるようになります。

## 一括インポート

絵文字は、特別な形式でパッケージ化されたZIPファイルとして一括でインポートできます。
この機能は、カスタム絵文字メニューの右上隅にあるメニューボタンから利用できます。

:::warning

一括インポートは、既存の絵文字を上書きしたり、サーバーに問題を引き起こす可能性があります。
可能な限りご自身でエクスポートした絵文字のみをインポートするようにし、外部から一括インポートを行う場合は、信頼できるソースかどうかを確認してください。

:::

### パッケージ化された絵文字の形式

トップレベルには `meta.json` というファイルがあり、このファイルにはパッケージ化された絵文字に関する情報が含まれています。

このファイルの型定義は以下のようになり、`Meta` はファイル全体の構造です。

```typescript
class Meta {
	metaVersion: number;
	host: string;
	/**
	 * ECMAScript の `Date.prototype.toString` によって返される日時の表現。
	 */
	exportedAt: string;
	emojis: Emoji[];
}

class Emoji {
	downloaded: boolean;
	fileName: string;
	emoji: {
		id: string;
		updatedAt: string;
		name: string;
		host: null;
		category: string;
		originalUrl: string;
		publicUrl: string;
		uri: null;
		type: string;
		aliases: string[];
	};
}
```

`Meta` のフィールドは現在、絵文字のインポート時に使用またはチェックされていませんが、`emojis` フィールドは使用されます。

各 `Emoji` に対して:

- `downloaded`: 常に true に設定します。このフィールドがないか、true でない場合、その絵文字はインポートされません。
- `fileName`: パッケージ化されたファイル内の画像ファイルの名前。
- `emoji`: データベースに保存されていた絵文字に関連するデータ。以下の項目が現在使用されています:
  - `name`: ユーザーが入力する絵文字の名前、例: `blobfox`（ユーザーが `:blobfox:` と入力するとその絵文字が表示されます）。\
    同じ名前の絵文字が既に存在する場合、**上書きされます**
  - `category`: 絵文字のカテゴリ
  - `aliases`: 別名として追加される文字列のリスト。管理者UIではこれを「タグ」と呼びます。

## 絵文字の編集と削除

絵文字のプロパティは、ローカル絵文字のリストでクリックすることで編集できます。
カスタム絵文字をクリックすると、そのプロパティを編集するためのダイアログが開きます。
このダイアログでは、絵文字を削除することもできます。

:::danger

カスタム絵文字を削除すると、それを含む古いノートには絵文字の名前がテキストとして残ります。
その絵文字は正しく表示されなくなります。

:::

リモート絵文字は編集や削除ができないことに注意してください。

每個表情符號可以有一個名稱、類別和多個標籤。
類別用於表情符號選擇器的結構化。
在表情符號選擇器中搜尋時，標籤作為找尋表情符號所使用的別名。

編集が終わったら、ダイアログの右上隅にあるチェックマークをクリックして変更を保存します。

### 一括編集

絵文字は、検索フィールドの下にあるボックスをチェックすることで一括編集できます。
これを有効にすると、絵文字をクリックしても編集ダイアログが開くのではなく、絵文字が選択されます。

編集オプションは、チェックボックスの下にボタンとして表示されます。
通常の動作に戻るには、もう一度ボックスのチェックを外します。
